---
title: "테스트용 Notion MarkDown"
excerpt :"함 해보자 일단"
caterogies:
 - Blog
tags:
 - Blog

---
# 191217 서울교통공사 편성정보

- 191124 - 191127 1호선 - 8호선 특정구간 오전첨두 편성정보를 전달 받음

### 예시 케이스 확인

- 1) 공공API 도착 정보와 비교
- 2) 열차-차량(편성) 맵핑과 비교
- 결론
    - 열차번호의 맨 앞자리가 달라지는 경우는 큰 의미가 없는 것 같다.

        2031 = 3031 으로 간주하자

- 예시 케이스 탐색

    ![191217/Untitled.png](/assets/images/191217/Untitled.png)

    - 열차번호 이슈
        - 공공API에서는 3000번대로 나오는데, 서울교통공사에서 보내준 것은 2000번대

            ex) 3031 - 2031 - 264(T)

            - 208(3039)는 맵핑 잘못됨

        ![191217/Untitled%201.png](/assets/images/191217/Untitled%201.png)

    — '20191127———————————————————————————

    - 1) 공공API 도착 정보와 비교
        - 서울교통공사 자료에는
        - 191127 공공API 도착 정보
            - 7시 : 17대 / 8시 : 18대
            - 3000번대 열차번호가 여러개 존재하며, 6000번대 열차번호도 존재함
            - 그럼에도 열차번호 뒤의 두자리는 대체로 순서를 유지함
                - 97번 없음

                ![191217/Untitled%202.png](/assets/images/191217/Untitled%202.png)

        - 2) 열차-차량(편성) 맵핑과 비교
            - 49, 59, 97 누락

                ![191217/Untitled%203.png](/assets/images/191217/Untitled%203.png)

### 본격 탐색

- 서울교통공사 정보(A)와 자체 맵핑 로직(B)을 비교 (full-outer join)
    - Case1) 자체 로직에서 열차 누락
    - Case2) 자체 로직에서 다른 편성번호(차량)로 맵핑
    - Case3) 서울교통공사 정보에서 열차 누락

    ![191217/Untitled%204.png](/assets/images/191217/Untitled%204.png)

    ![191217/Untitled%205.png](/assets/images/191217/Untitled%205.png)

- 서울교통공사 정보(A)를 정답으로 보았을 때 자체 맵핑 로직(B)이 얼마나 부족할까?

    ![191217/Untitled%206.png](/assets/images/191217/Untitled%206.png)

    - 운행열차수 : 서울교통공사 정보(A)에서 알린 운행대수
    - 열차맵핑성공 : 실제로 운행된 열차를 로직(B)도 운행한다고 판단했는지
    - 차량번호일치 : (A)의 편성번호와 (B)의 편성번호가 동일한지
- 결과
    - `2호선`이 가장 맵핑이 잘 안 된다
    - `3호선` 과 `8호선` 은 맵핑이 100%

- 2호선 상세
    - 어떤 열차들이 잘 맵핑이 안되거나, 차량번호가 일치하지 않았을까?
        - 마지막 오류 편성번호를 제외하면, 대체로 맵핑이 안되는 열차들이 계속 맵핑이 안된다.
            - `214`, `240`, `242`, `285`, `286`, `287`, `288`, `289`

        ![191217/Untitled%207.png](/assets/images/191217/Untitled%207.png)

        - 해당 번호의 T-wifi 지하철객차 AP meta를 확인
            - 해당 번호의 지하철객차 AP가 없거나 오류가 생겼을 수 있음
            - ⇒ default.subway_train_twifi_meta (dt =${yyyymmdd})
                - `240`, `241`, `244`, `249`, `250`, `251`, `252`, `253`, `254`, `255`, `285`, `289` 차량 T-wifi AP 없음
                - 해당 차량이 원래 없어서 AP가 없다고 생각 → 차량 있지만 AP가 없음
            - ⇒ twifi_raw.twifi_ap 찾아보았는데도 해당 차량의 AP 없음
            - ⇒ edw_raw.uatf_ap_info
                - 안보여~

- 4호선 상세
    - ㅇㅇㅇ
        - 

        ![191217/Untitled%208.png](/assets/images/191217/Untitled%208.png)

        - Public API 기준
            - 4015 — (18분) — 4017

            ![191217/Untitled%209.png](191217/Untitled%209.png)

        - T-wifi AP 시간표
            - 405 — (16~18분) — 408

            ![191217/Untitled%2010.png](191217/Untitled%2010.png)

        - 결론
            - 
- 5호선 상세

    ![191217/Untitled%2011.png](191217/Untitled%2011.png)

- 6호선 상세
    - 

    ![191217/Untitled%2012.png](191217/Untitled%2012.png)

- 7호선 상세
    - 7호선 맵핑이 잘 안되었음
    - 7호선 열차에 6호선 편성번호에 해당하는 경우가 존재함

    ![191217/Untitled%2013.png](191217/Untitled%2013.png)

---
